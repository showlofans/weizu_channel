查询优化

导出分析，它没有显示城市信息，一可能是隐私，二可能是调用接口问题

充值成功统计信息，包括订单数，总面值，总扣款
如果查询参数不变就去统计一遍

searchParam是一个，下一次的searchparam
怎么得到上一次的searchParam
如果不一样就返回true，让系统再按照新的查询参数统计一次

session的特点，只在登陆的那次进行统计，其他的如果没改，就不统计，
直接把统计的结果也放在session里

代理商统计的是他自己向上提的订单（当然他所有的订单都会提到我们这里）

有很多个下级代理商，又怎么区分是哪个代理商提过来的呢

时间控件清空得到的结果是null；手动清空就能得到所有该时间内的记录

统计的时候只统计子代理商的记录（看数据对不对：不对）

如果是超级用户，就只统计子代理商的，
如果不是就两个一起统计，会有一个问题就是原价和扣款数不对应；
将总金额除以2是正确的算法吗，
是不是每笔扣款都对应了两个子父代理商的两个包体原价

子代理商在父类代理商那的订单状态，以及订单在子代理商那里的状态是不一样的
订单在子代理商那的扣款，以及在父代理商那的扣款

父代理商只能找到订单在子代理商的扣款和订单在自己那的扣款

同一个订单自己的扣款（成本），子代理商的扣款（价格）
能找到子代理商的订单，和自己订单部分的订单状态和扣款


代理商名字是子代理商，



父级代理商表示自己
（订单号随便，手机号随便，流量大小，面值由订单号决定也是随便，提交时间由订单号决定，号码归属，城市随手机号）订单号

充值方式是父代理商决定

扣款，扣款类型由父代理商决定，
agency_purchase：是订单与父级代理商绑定的列表，再加上一个子代理商id就能找到子代理商的名字了

超级管理员操作了订单状态，同时要更新订单状态（手动成功和失败，只有我们才能操作，下级代理商不能操作）充值时间，统一由回调设置（也就是由超管决定）
结果状态由超管控制

订单状态是一起的状态，充值时间，所以应该放在订单表里

从下级的订单，全部转化为自己的订单
怎么找到自己的订单呢，所有的这些都被内化为自己的订单了

下级代理商有订单表的创建记录权，超管有修改订单表的状态，修改通道，修改其他系统返回来的订单和充值时间的权利

只有父代理商的扣款（成本），那子代理商的扣款（价格）呢；尾巴上的价格

再加上一个字段，isSecond，如果是,就找出来，


把自己是来源的订单，和自己不是来源的订单，都加上去

如果订单表的agencyid和连接表的代理商id相同，那成本和价格都一样，只查开始的价格




