window.PAGE_ACTION = function() {
    "use strict";
    var a = null,
    l = null,
    e = null,
    t = null,
    i = null;
    return a = function() {
        $("#telphone").blur(function() {
            var a = $("#telphone").val();
            if ("" != a) {
                var e = a.split(",");
                DXTX.api.yysGet({
                    type: "get",
                    data: {
                        mobile: e[0]
                    },
                    successCallBack: function(a) {
                        $("#city").val(a.data.city),
                        $("#province").val(a.data.province),
                        $("#phonepro").val(a.data.carrier);
                        var e = a.data.carrier;
                        e.indexOf("移动") >= 0 && $("#phonetype").val("1"),
                        e.indexOf("联通") >= 0 && $("#phonetype").val("2"),
                        e.indexOf("电信") >= 0 && $("#phonetype").val("3"),
                        l($("#phonetype").val()),
                        i($("#phonetype").val(), $("#province").val())
                    },
                    failCallBack: function(a) {
                        console.log(a)
                    }
                })
            }
        })
    },
    l = function(a) {
        DXTX.api.packageGet({
            type: "get",
            data: {
                chtype: a,
                status: 1
            },
            successCallBack: function(a) {
                $("#selecflow").empty(),
                $.each(a.data,
                function() {
                    $("#selecflow").append("<a href='#' ><li class='col-sm-3 fy-li' id='mz" + this.id + "' value='" + this.id + "'>" + this.name + "</li>")
                }),
                $("#selecflow a").click(function(l) {
                    l.preventDefault();
                    var e = $(l.target).attr("value");
                    $.each(a.data,
                    function() {
                        if (e == this.id) {
                            $("#flowname").val(this.name),
                            $("#flowsize").val(this.flow),
                            $("#needcash").val(this.baseprice),
                            $("#gfbj").html("官方报价：" + this.baseprice);
                            var a = $("#feilv").val(),
                            l = this.baseprice * a;
                            $("#realcash").val(l.toFixed(2)),
                            $("#realcash").css("color", "red")
                        }
                    })
                })
            },
            failCallBack: DXTX.utils.failCallBack
        })
    },
    i = function(a, l) {
        DXTX.api.feilvGet({
            type: "get",
            data: {
                chtype: a,
                province: l
            },
            successCallBack: function(a) {
                $("#feilv").val(a.ctdis)
            },
            failCallBack: DXTX.utils.failCallBack
        })
    },
    e = function() {
        $("#realcash").focus(function() {
            "" == $("#flow").val() ? alert("未选择流量面值") : $("#realcash").val()
        })
    },
    t = function() {
        $("#addForm").submit(function(a) {
            a.preventDefault();
            var l = $("#telphone").val(),
            e = l.split(",");
            $.each(e,
            function() {
                var a = $("#addForm").serializeJson();
                a.telphone = this,
                DXTX.api.ticketList({
                    type: "post",
                    data: a,
                    successCallBack: function(a) {
                        $.messager.alert(a.message)
                    },
                    failCallBack: DXTX.utils.failCallBack
                })
            }),
            DXTX.utils.dumpReload(),
            $("#addForm")[0].reset()
        })
    },
    {
        init: function() {
            DXTX.utils.leftMenuInit("flowBatch"),
            a(),
            e(),
            t()
        }
    }
};